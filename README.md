# LanSchool Mass Deployment for Windows

This project provides a robust, unattended batch script for mass deploying the LanSchool Student client to Windows machines in a classroom or lab environment. The script is designed for use with Group Policy or other machine-based deployment tools and assumes it will only run on student computers.

## Features
- Silent installation of LanSchool Student via MSI
- Configurable classroom channel assignment
- Privacy-focused options (no keystroke or internet monitoring, stealth mode)
- Automatic logging of installation success or failure
- Uses absolute file paths and network locations
- Supports LanSchool Connection Service (LCS)

## Usage
1. **Configure the Channel**
   - Edit the `LanSchool.bat` file and set the `CHANNEL` variable to the unique room/channel number (1–16000):
     ```bat
     SET CHANNEL=803
     ```
2. **Deploy the Script**
   - Use Group Policy, SCCM, or another deployment tool to run `LanSchool.bat` as a machine startup script on student computers.

3. **Script Logic**
   - If the LanSchool Student client is not already installed, the script will:
     - Run the MSI installer from a network share
     - Apply the following options:
       - `ADVANCED_OPTIONS=1`
       - `STEALTH_MODE=1`
       - `NO_KEYBOARD_MONITORING_MODE=1`
       - `NO_INTERNET_MONITORING_MODE=1`
       - `CHANNEL=<your channel>`
       - `LCS=192.168.254.20`
     - Log the result (success or failure) to `C:\LanSchoolInstall.log`

## Example Script
```bat
@echo off
REM Set CHANNEL variable to the unique room channel number (numeric value 1 - 16000)
SET CHANNEL=803

REM Install LanSchool Student if not already installed
IF NOT EXIST "C:\Program Files (x86)\LanSchool\student.exe" (
    msiexec.exe /i "\\sccm2\Deployment\Software\LanSchool\latest\Student.msi" /qn ADVANCED_OPTIONS=1 STEALTH_MODE=1 NO_KEYBOARD_MONITORING_MODE=1 NO_INTERNET_MONITORING_MODE=1 CHANNEL=%CHANNEL% LCS=192.168.254.20
    IF %ERRORLEVEL% EQU 0 (
        echo [%DATE% %TIME%] LanSchool Student install succeeded on %COMPUTERNAME% >> C:\LanSchoolInstall.log 2>nul
    ) ELSE (
        echo [%DATE% %TIME%] LanSchool Student install failed on %COMPUTERNAME% >> C:\LanSchoolInstall.log 2>nul
    )
)
```

## Requirements
- Windows 10/11
- Network access to the MSI installer location
- Administrator privileges (script should run as SYSTEM or with admin rights)

## Customization
- Adjust the `CHANNEL` variable as needed for each room.
- Update the network path to the MSI if your deployment share changes.
- Additional LanSchool MSI options can be added as required (see [LanSchool documentation](https://helpdesk.lanschool.com/portal/en/kb/articles/mass-deploying-lanschool-student-for-windows)).

## Logging
- Installation results are logged to `C:\LanSchoolInstall.log`.
- Errors writing to the log file are suppressed to avoid script interruption.

## License
This project is provided as-is for educational and deployment automation purposes. See LanSchool's licensing for product usage terms.

## References
- [LanSchool Mass Deployment Documentation](https://helpdesk.lanschool.com/portal/en/kb/articles/mass-deploying-lanschool-student-for-windows)
- [Microsoft: Group Policy Startup Scripts](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/startup-scripts)

## Channel Numbering Convention

Channel numbers are generated by combining the alphabetical position of the room letter with the two-digit room number. For example:

- Room H3 → H is the 8th letter, 3 as two digits → **803**
- Room A1 → A is the 1st letter, 1 as two digits → **101**
- Room B12 → B is the 2nd letter, 12 as two digits → **212**

**Formula:**

    Channel = <Letter Position><Two-digit Room Number>

This ensures each room has a unique channel between 101 and 2699 (for Z99).
