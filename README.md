# LanSchool Mass Deployment for Windows

This project provides a robust, unattended batch script for mass deploying the LanSchool Student client to Windows 11 machines in a classroom or lab environment. The script is designed for use with Group Policy or other machine-based deployment tools and assumes it will only run on student computers.

## Features
- Silent installation of LanSchool Student via MSI
- Configurable classroom channel assignment
- Privacy-focused options (no keystroke or internet monitoring, stealth mode)
- Automatic logging of installation success or failure
- Uses absolute file paths and network locations
- Supports LanSchool Connection Service (LCS)

## Requirements
- Windows 11
- Network access to the MSI installer location
- Administrator privileges (script should run as SYSTEM or with admin rights)

## Channel Numbering Convention

Channel numbers are generated by combining the alphabetical position of the room letter with the two-digit room number. For example:

- Room H3 → H is the 8th letter, 3 as two digits → **803**
- Room A1 → A is the 1st letter, 1 as two digits → **101**
- Room B12 → B is the 2nd letter, 12 as two digits → **212**
- Room N14 → N is the 14th letter, 14 as two digits → **1414**
- Room G7 → G is the 7th letter, 7 as two digits → **707**

**Formula:**

    Channel = <Letter Position><Two-digit Room Number>

This ensures each room has a unique channel between 101 and 2699 (for Z99).

## Usage
1. **Configure the Channel**
   - Edit the `LanSchool.bat` file and set the `CHANNEL` variable to the unique room/channel number (see above for how to generate it):
     ```bat
     SET CHANNEL=803
     ```
2. **Deploy the Script**
   - Use Group Policy, SCCM, or another deployment tool to run `LanSchool.bat` as a machine startup script on student computers.

3. **Script Logic**
   - If the LanSchool Student client is not already installed, the script will:
     - Run the MSI installer from a network share
     - Apply the following options:
       - `ADVANCED_OPTIONS=1`
       - `STEALTH_MODE=1`
       - `NO_KEYBOARD_MONITORING_MODE=1`
       - `NO_INTERNET_MONITORING_MODE=1`
       - `CHANNEL=<your channel>`
       - `LCS=192.168.254.20`
     - Log the result (success or failure) to `C:\LanSchoolInstall.log`

## Example Usage
Set the `CHANNEL` variable in your batch file to match your room's channel number, then deploy the script as described above.

For example:

- For room H3, set `SET CHANNEL=803`
- For room N14, set `SET CHANNEL=1414`

The script will handle installation and logging automatically.

## Customization
- Adjust the `CHANNEL` variable as needed for each room.
- Update the network path to the MSI if your deployment share changes.
- Additional LanSchool MSI options can be added as required (see [LanSchool documentation](https://helpdesk.lanschool.com/portal/en/kb/articles/mass-deploying-lanschool-student-for-windows)).

## Logging
- Installation results are logged to `C:\LanSchoolInstall.log`.
- Errors writing to the log file are suppressed to avoid script interruption.

## License
This project is provided as-is for educational and deployment automation purposes. See LanSchool's licensing for product usage terms.

## References
- [LanSchool Mass Deployment Documentation](https://helpdesk.lanschool.com/portal/en/kb/articles/mass-deploying-lanschool-student-for-windows)
- [Microsoft: Group Policy Startup Scripts](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/startup-scripts)
