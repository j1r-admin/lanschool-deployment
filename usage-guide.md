

# LanSchool Deployment Usage Guide

This guide explains how to configure and use the LanSchool Student deployment script with Group Policy in a Windows 11 environment. It covers script customization, channel assignment, deployment workflow, best practices, and troubleshooting.

## 1. Channel Numbering Convention

Channel numbers are generated by combining the alphabetical position of the room letter with the two-digit room number. For example:

- Room H3 → H is the 8th letter, 3 as two digits → **803**
- Room A1 → A is the 1st letter, 1 as two digits → **101**
- Room B12 → B is the 2nd letter, 12 as two digits → **212**
- Room N14 → N is the 14th letter, 14 as two digits → **1414**
- Room G7 → G is the 7th letter, 7 as two digits → **707**

**Formula:**

    Channel = <Letter Position><Two-digit Room Number>

This ensures each room has a unique channel between 101 and 2699 (for Z99).

---

## 2. Workflow Overview

### Step 1: Configure the Script
1. Open `LanSchool.bat` in a text editor.
2. Set the `CHANNEL` variable to match your room, using the channel numbering convention above.
   - Example for room H3:
     ```bat
     SET CHANNEL=803
     ```
3. Save and distribute the customized script for each room as needed.

### Step 2: Deploy via Group Policy
1. **Open Group Policy Management Console (GPMC):**
   - On your domain controller, run `gpmc.msc`.
2. **Create a New GPO:**
   - Right-click the appropriate OU (Organizational Unit) and select "Create a GPO in this domain, and Link it here..."
   - Name the GPO using the convention: `[Software Installation] LanSchool <Room>` (e.g., `[Software Installation] LanSchool H3`).
3. **Edit the GPO:**
   - Right-click the new GPO and select "Edit".
   - Navigate to: `Computer Configuration > Policies > Windows Settings > Scripts (Startup/Shutdown)`
   - Double-click "Startup", then click "Add..."
   - Browse to and select your customized `LanSchool.bat` script.
4. **Ensure Script Accessibility:**
   - The script and MSI must be accessible to all target computers (use a UNC path).
5. **Apply and Close:**
   - Click OK to save changes and close the GPO editor.
6. **Force Group Policy Update (optional):**
   - On a target machine, run `gpupdate /force` to apply the new policy immediately.

---

## 3. Best Practices

- Use a separate GPO for each room.
- Double-check the `CHANNEL` variable for each script to avoid channel conflicts.
- Keep a record of channel assignments and GPO names for troubleshooting.
- Monitor `C:\LanSchoolInstall.log` on client machines for installation results.
- Ensure scripts are run with sufficient privileges (machine startup, not user logon).

---

## 4. Troubleshooting

If installation fails, check:

- Network connectivity to the MSI share
- Permissions on the script and MSI files
- The log file at `C:\LanSchoolInstall.log`
- That the script is running as a startup script (not logon)

---

## 5. References

- [LanSchool Mass Deployment Documentation](https://helpdesk.lanschool.com/portal/en/kb/articles/mass-deploying-lanschool-student-for-windows)
- [Microsoft: Group Policy Startup Scripts](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/startup-scripts)

---

For further assistance, contact your IT administrator or refer to the technical documentation in this repository.
